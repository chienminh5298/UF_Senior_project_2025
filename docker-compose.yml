services:
    ufdatabase:
        image: 'mysql'
        environment:
            MYSQL_ROOT_PASSWORD: moneymachine
            MYSQL_DATABASE: moneymachine
        volumes:
            - ./backupDB:/docker-entrypoint-initdb.d
            - db-volume:/var/lib/mysql
        healthcheck:
            test: ['CMD', 'mysqladmin', 'ping', '-h', 'localhost']
            timeout: 5s
            retries: 1
        ports:
            - '3306:3306'
        container_name: ufdatabase
    bottrade:
        build:
            context: ./botTrade
            dockerfile: Dockerfile.dev
        depends_on:
            ufdatabase:
                condition: service_healthy
        ports:
            - '9999:9999'
        env_file: ./botTrade/.env
        volumes:
            - ./botTrade:/app            # Mount local source for hot-reload
            - /app/node_modules          # Prevent overwriting node_modules
            - log-volume:/app/log
            # - ~/.aws:/root/.aws:ro
        container_name: bottrade
volumes:
    db-volume:
    log-volume:
